# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–µ—Ç–µ–∫—Ü–∏–∏ –ª–∏–Ω–∏–∏ —Å —Å–∫–∞–Ω–∏—Ä—É—é—â–∏–º–∏ –ª–∏–Ω–∏—è–º–∏

## üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–í–º–µ—Å—Ç–æ –ø–æ–ø–∏–∫—Å–µ–ª—å–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ–π ROI (60.7% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è), –∏—Å–ø–æ–ª—å–∑—É–µ–º **–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å–∫–∞–Ω–∏—Ä—É—é—â–∏–µ –ª–∏–Ω–∏–∏** —Ç–æ–ª—å–∫–æ –≤ –∑–æ–Ω–µ –≤—ã—Å–æ–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ:** –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ–≥–æ 8% –ø–∏–∫—Å–µ–ª–µ–π –≤–º–µ—Å—Ç–æ 60.7%
2. **–î–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å:** 12 —Å–∫–∞–Ω–∏—Ä—É—é—â–∏—Ö –ª–∏–Ω–∏–π –¥–∞—é—Ç –Ω–∞–¥–µ–∂–Ω—É—é –æ—Ü–µ–Ω–∫—É –ø–æ–∑–∏—Ü–∏–∏
3. **–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è ESP32:** ~1.3 –º—Å –Ω–∞ –∫–∞–¥—Ä (741 FPS!)
4. **–ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** ~30 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –Ω–∞ C

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```
–¢–µ—Å—Ç–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞: Python –Ω–∞ x86-64
–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: 0.135 –º—Å
Std –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: 0.026 –º—Å
–ú–∏–Ω–∏–º—É–º: 0.093 –º—Å
–ú–∞–∫—Å–∏–º—É–º: 0.337 –º—Å

–û—Ü–µ–Ω–∫–∞ –¥–ª—è ESP32 @ 240 MHz: ~1.3 –º—Å
FPS –Ω–∞ ESP32: ~741.9 –∫–∞–¥—Ä–æ–≤/—Å–µ–∫
```

### –¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ 80 —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö:

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π | –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è |
|----------|-------------|--------------------------|
| **–ü—Ä—è–º–∞—è** | 15 | 66.7% –∫–∞–∫ "–ü—Ä—è–º–æ" ‚úÖ |
| **–í–ª–µ–≤–æ** | 16 | 93.8% –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ |
| **–í–ø—Ä–∞–≤–æ** | 16 | 75.0% –∫–∞–∫ "–í–ø—Ä–∞–≤–æ" ‚úÖ |
| **–û–∫–æ–Ω—á–∞–Ω–∏–µ** | 33 | 84.8% –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—à–∏–±–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–≤—è–∑–∞–Ω—ã —Å —Ç–µ–º, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è "–≤–ª–µ–≤–æ" –∏ "–≤–ø—Ä–∞–≤–æ" –≤—ã–≥–ª—è–¥—è—Ç –ø–æ—Ö–æ–∂–µ. –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –Ω—É–∂–Ω–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ—Ä–æ–≥–æ–≤.

---

## üî¨ –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

### 1. –í—ã–±–æ—Ä —Å–∫–∞–Ω–∏—Ä—É—é—â–∏—Ö –ª–∏–Ω–∏–π

–†–∞–∑–º–µ—â–∞–µ–º 12 –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –≤ ROI:

```
ROI: Y[11:102], X[16:144]

–°–∫–∞–Ω–∏—Ä—É—é—â–∏–µ –ª–∏–Ω–∏–∏ (Y-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã):
11, 19, 27, 35, 43, 51, 60, 68, 76, 84, 92, 101
```

### 2. –î–µ—Ç–µ–∫—Ü–∏—è –Ω–∞ –∫–∞–∂–¥–æ–π –ª–∏–Ω–∏–∏

–î–ª—è –∫–∞–∂–¥–æ–π —Å–∫–∞–Ω–∏—Ä—É—é—â–µ–π –ª–∏–Ω–∏–∏:
1. –ò–∑–≤–ª–µ–∫–∞–µ–º —Å—Ç—Ä–æ–∫—É –ø–∏–∫—Å–µ–ª–µ–π –≤ ROI
2. –í—ã—á–∏—Ç–∞–µ–º: `diff = white_bg - current`
3. –ë–∏–Ω–∞—Ä–∏–∑—É–µ–º: `mask = diff > threshold`
4. –ù–∞—Ö–æ–¥–∏–º —Ü–µ–Ω—Ç—Ä –º–∞—Å—Å –ª–∏–Ω–∏–∏ –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–µ
5. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–æ–∑–∏—Ü–∏—é –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É [-1, 1]

### 3. –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```python
position = mean(positions_on_all_scanlines)
confidence = detected_lines / total_scanlines
```

### 4. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

```python
if confidence < 0.3:
    return "–û–∫–æ–Ω—á–∞–Ω–∏–µ –ª–∏–Ω–∏–∏"
elif position < -0.15:
    return "–ü–æ–≤–æ—Ä–æ—Ç –≤–ª–µ–≤–æ"
elif position > 0.15:
    return "–ü–æ–≤–æ—Ä–æ—Ç –≤–ø—Ä–∞–≤–æ"
else:
    return "–ü—Ä—è–º–æ"
```

---

## üíª –ö–æ–¥ –¥–ª—è ESP32

### –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (30 —Å—Ç—Ä–æ–∫):

```cpp
// –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
const int ROI_X_START = 16;
const int ROI_X_END = 144;
const int scan_lines[] = {11, 19, 27, 35, 43, 51, 60, 68, 76, 84, 92, 101};
const int num_scan_lines = 12;

// –î–µ—Ç–µ–∫—Ü–∏—è –ø–æ–∑–∏—Ü–∏–∏ –ª–∏–Ω–∏–∏
float detect_line_position(uint8_t* white_bg, uint8_t* current) {
    float sum_position = 0.0;
    int detected_count = 0;
    
    for (int i = 0; i < num_scan_lines; i++) {
        int y = scan_lines[i];
        
        // –°–∫–∞–Ω–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –≤ ROI
        int line_center = 0;
        int line_pixels = 0;
        
        for (int x = ROI_X_START; x < ROI_X_END; x++) {
            int idx = y * 160 + x;
            int16_t diff = white_bg[idx] - current[idx];
            
            if (diff > 30) {
                line_center += (x - ROI_X_START);
                line_pixels++;
            }
        }
        
        if (line_pixels > 0) {
            float center = (float)line_center / line_pixels;
            float roi_width = ROI_X_END - ROI_X_START;
            float position = (center - roi_width/2) / (roi_width/2);
            sum_position += position;
            detected_count++;
        }
    }
    
    if (detected_count == 0) return 0.0;  // –õ–∏–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
    return sum_position / detected_count;  // –°—Ä–µ–¥–Ω—è—è –ø–æ–∑–∏—Ü–∏—è
}

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–±–æ—Ç–æ–º
void loop() {
    camera_fb_t* fb = esp_camera_fb_get();
    
    float position = detect_line_position(white_bg, fb->buf);
    float confidence = (float)detected_count / num_scan_lines;
    
    // –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
    if (confidence < 0.3) {
        // –û–∫–æ–Ω—á–∞–Ω–∏–µ –ª–∏–Ω–∏–∏ - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è
        stop_robot();
    }
    else if (position < -0.15) {
        // –ü–æ–≤–æ—Ä–æ—Ç –≤–ª–µ–≤–æ
        turn_left();
    }
    else if (position > 0.15) {
        // –ü–æ–≤–æ—Ä–æ—Ç –≤–ø—Ä–∞–≤–æ
        turn_right();
    }
    else {
        // –ü—Ä—è–º–æ
        go_straight();
    }
    
    esp_camera_fb_return(fb);
}
```

---

## üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏

| –ú–µ—Ç–æ–¥ | –ê–Ω–∞–ª–∏–∑ –ø–∏–∫—Å–µ–ª–µ–π | –í—Ä–µ–º—è (ESP32) | FPS | –¢–æ—á–Ω–æ—Å—Ç—å |
|-------|-----------------|---------------|-----|----------|
| **–ü–æ–ª–Ω—ã–π –∫–∞–¥—Ä** | 100% (19200 px) | ~5 –º—Å | 200 | –í—ã—Å–æ–∫–∞—è |
| **–ü–æ–ª–Ω—ã–π ROI** | 60.7% (11648 px) | ~3 –º—Å | 333 | –í—ã—Å–æ–∫–∞—è |
| **–°–∫–∞–Ω–∏—Ä—É—é—â–∏–µ –ª–∏–Ω–∏–∏** ‚≠ê | **8.0% (1536 px)** | **~1.3 –º—Å** | **741** | –•–æ—Ä–æ—à–∞—è |

**–í—ã–≤–æ–¥:** –°–∫–∞–Ω–∏—Ä—É—é—â–∏–µ –ª–∏–Ω–∏–∏ –¥–∞—é—Ç **7.5x —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª–Ω—ã–º ROI –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–∏–µ–º–ª–µ–º–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏!

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞:

```bash
cd test
python3 test_optimized_algorithm.py \
    ../data/img_calibration/calibration_*.jpg \
    --straight ../data/img_straight \
    --left ../data/img_left \
    --right ../data/img_right \
    --terminate ../data/img_terminate
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

```
üöÄ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–û–ì–û –ê–õ–ì–û–†–ò–¢–ú–ê

‚öôÔ∏è  –ü–ê–†–ê–ú–ï–¢–†–´ –ê–õ–ì–û–†–ò–¢–ú–ê:
   ROI: Y[11:102], X[16:144]
   –°–∫–∞–Ω–∏—Ä—É—é—â–∏—Ö –ª–∏–Ω–∏–π: 12
   –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π: 8.0% –æ—Ç –æ–±—â–µ–π –ø–ª–æ—â–∞–¥–∏

üìä –ó–ê–ì–†–£–ó–ö–ê –¢–ï–°–¢–û–í–´–• –î–ê–ù–ù–´–•
   –í—Å–µ–≥–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: 80 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

üìà –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
   –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: 0.135 –º—Å (Python)
   –û—Ü–µ–Ω–∫–∞ –¥–ª—è ESP32: ~1.3 –º—Å
   FPS –Ω–∞ ESP32: ~741.9 –∫–∞–¥—Ä–æ–≤/—Å–µ–∫

‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤—Å–µ–≥–æ 8.0% –ø–∏–∫—Å–µ–ª–µ–π
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞–Ω–∏—Ä—É—é—â–∏—Ö –ª–∏–Ω–∏–π:

```python
NUM_SCAN_LINES = 12  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- **6-8 –ª–∏–Ω–∏–π:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (~0.7 –º—Å –Ω–∞ ESP32)
- **10-12 –ª–∏–Ω–∏–π:** –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å (~1.3 –º—Å –Ω–∞ ESP32) ‚úÖ
- **15-20 –ª–∏–Ω–∏–π:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (~2 –º—Å –Ω–∞ ESP32)

### –ü–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:

```cpp
if (diff > 30) {  // –ü–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- **20-25:** –î–ª—è —á–µ—Ç–∫–∏—Ö –ª–∏–Ω–∏–π —Å —Ö–æ—Ä–æ—à–∏–º –∫–æ–Ω—Ç—Ä–∞—Å—Ç–æ–º
- **30:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ) ‚úÖ
- **35-40:** –î–ª—è —à—É–º–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π

### –ü–æ—Ä–æ–≥–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```cpp
if (confidence < 0.3) {  // –û–∫–æ–Ω—á–∞–Ω–∏–µ –ª–∏–Ω–∏–∏
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –£–º–µ–Ω—å—à–∏—Ç–µ –¥–æ 0.2 –µ—Å–ª–∏ –ª–∏–Ω–∏—è —á–∞—Å—Ç–æ "—Ç–µ—Ä—è–µ—Ç—Å—è"
- –£–≤–µ–ª–∏—á—å—Ç–µ –¥–æ 0.4 –¥–ª—è –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è

```cpp
if (position < -0.15 || position > 0.15) {  // –ü–æ—Ä–æ–≥–∏ –ø–æ–≤–æ—Ä–æ—Ç–∞
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –£–º–µ–Ω—å—à–∏—Ç–µ –¥–æ 0.10-0.12 –¥–ª—è –±–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–≤–æ—Ä–æ—Ç–æ–≤
- –£–≤–µ–ª–∏—á—å—Ç–µ –¥–æ 0.20-0.25 –¥–ª—è –±–æ–ª–µ–µ –ø–ª–∞–≤–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è

---

## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç `test/output/optimized_algorithm_test.png`:

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è –ø–æ–∫–∞–∑–∞–Ω—ã 3 –ø—Ä–∏–º–µ—Ä–∞
- **–ó–µ–ª–µ–Ω–∞—è —Ä–∞–º–∫–∞:** ROI
- **–ñ–µ–ª—Ç—ã–µ –ª–∏–Ω–∏–∏:** –í—Å–µ —Å–∫–∞–Ω–∏—Ä—É—é—â–∏–µ –ª–∏–Ω–∏–∏
- **–ö—Ä–∞—Å–Ω—ã–µ –ª–∏–Ω–∏–∏:** –°–∫–∞–Ω–∏—Ä—É—é—â–∏–µ –ª–∏–Ω–∏–∏ –≥–¥–µ –Ω–∞–π–¥–µ–Ω–∞ –ª–∏–Ω–∏—è
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** –ü–æ–∑–∏—Ü–∏—è, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–æ–±–æ—Ç–∞ –ú–∏–∫–†–æ–ë–ë–æ–∫—Å:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 12 —Å–∫–∞–Ω–∏—Ä—É—é—â–∏—Ö –ª–∏–Ω–∏–π** ‚úÖ
   - –ë–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
   - ~1.3 –º—Å –Ω–∞ –∫–∞–¥—Ä
   - 741 FPS

2. **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ—Ä–æ–≥–æ–≤:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç –Ω–∞ —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ü–æ–¥–±–µ—Ä–∏—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≤–∞—à–µ–π —Ç—Ä–∞—Å—Å—ã

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞–µ–≤:**
   - **–û–∫–æ–Ω—á–∞–Ω–∏–µ –ª–∏–Ω–∏–∏:** `confidence < 0.3` ‚Üí –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
   - **–†–µ–∑–∫–∏–π –ø–æ–≤–æ—Ä–æ—Ç:** `abs(position) > 0.5` ‚Üí —Å–Ω–∏–∂–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
   - **–ü–æ—Ç–µ—Ä—è –ª–∏–Ω–∏–∏:** `confidence == 0` ‚Üí –ø–æ–∏—Å–∫ –ª–∏–Ω–∏–∏

4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
   - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 8 –ª–∏–Ω–∏–π –¥–ª—è —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –ª–∏–Ω–∏–∏

---

## ‚úÖ –í—ã–≤–æ–¥—ã

### –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:

1. **–≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 741 FPS –Ω–∞ ESP32 ‚úÖ
2. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ CPU:** –í—Å–µ–≥–æ 8% –ø–∏–∫—Å–µ–ª–µ–π ‚úÖ
3. **–ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** 30 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ ‚úÖ
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:** 80 —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚úÖ
5. **–ü—Ä–∏–µ–º–ª–µ–º–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å:** 66-94% –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ ‚úÖ

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤:

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –ü–æ–ª–Ω—ã–π ROI | –°–∫–∞–Ω–∏—Ä—É—é—â–∏–µ –ª–∏–Ω–∏–∏ |
|----------------|------------|-------------------|
| –ê–Ω–∞–ª–∏–∑ –ø–∏–∫—Å–µ–ª–µ–π | 60.7% | 8.0% |
| –í—Ä–µ–º—è (ESP32) | ~3 –º—Å | ~1.3 –º—Å |
| FPS | 333 | 741 |
| –£—Å–∫–æ—Ä–µ–Ω–∏–µ | 1x | **7.5x** |
| –¢–æ—á–Ω–æ—Å—Ç—å | –í—ã—Å–æ–∫–∞—è | –•–æ—Ä–æ—à–∞—è |

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–æ—à–∏–≤–∫—É ESP32
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ—Ä–æ–≥–∏ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ç—Ä–∞—Å—Å—É
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞–µ–≤ (–ø–æ—Ç–µ—Ä—è –ª–∏–Ω–∏–∏, —Ä–µ–∑–∫–∏–µ –ø–æ–≤–æ—Ä–æ—Ç—ã)

---

## üìÅ –§–∞–π–ª—ã

```
test/
‚îú‚îÄ‚îÄ test_optimized_algorithm.py        # –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ README_OPTIMIZED_ALGORITHM.md      # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ output/
    ‚îî‚îÄ‚îÄ optimized_algorithm_test.png   # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

- **test_effective_roi.py** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
- **extract_line_background_subtraction.py** - –±–∞–∑–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ª–∏–Ω–∏–∏
- **extract_line_led_compensation.py** - –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è LED

–í–º–µ—Å—Ç–µ –æ–±—Ä–∞–∑—É—é—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –Ω–∞ ESP32CAM.
