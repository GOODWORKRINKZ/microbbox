; PlatformIO Project Configuration File
; МикРоББокс - миниатюрный робот на ESP32CAM
;
; Build options: build flags, source filter
; Upload options: custom upload port, speed and extra flags  
; Library options: dependencies, extra library storages
; Advanced options: extra scripting
;
; ═══════════════════════════════════════════════════════════════
; КОНФИГУРАЦИЯ В СТИЛЕ ELRS - МНОЖЕСТВЕННЫЕ ТАРГЕТЫ
; ═══════════════════════════════════════════════════════════════
; Доступные конфигурации:
; - classic-debug/release: МикроБокс Классик (управляемый робот)
; - liner-debug/release: МикроБокс Лайнер (следование по линии)
; - brain-debug/release: МикроБокс Брейн (модуль управления)

[env]
platform = espressif32
board = esp32cam
framework = arduino
board_build.partitions = partitions.csv
extra_scripts = 
    pre:scripts/install_deps.py
    pre:scripts/embed_resources.py
    pre:scripts/generate_version.py
build_flags =
    -std=c++17
    -D USE_EMBEDDED_RESOURCES
    -fexceptions
    -Iinclude
lib_deps =
    ottowinter/ESPAsyncWebServer-esphome @ ^3.0.0
    adafruit/Adafruit NeoPixel @ ^1.10.7
lib_ldf_mode = chain+
monitor_speed = 115200
upload_speed = 921600

; ═══════════════════════════════════════════════════════════════
; МИКРОБОКС КЛАССИК - Полнофункциональный управляемый робот
; ═══════════════════════════════════════════════════════════════

[env:classic-debug]
extends = env
build_flags =
    ${env.build_flags}
    -D TARGET_CLASSIC
    -D DEBUG=1
    -D CORE_DEBUG_LEVEL=4

[env:classic-release]
extends = env
build_flags =
    ${env.build_flags}
    -D TARGET_CLASSIC
    -D DEBUG=0
    -O2

; ═══════════════════════════════════════════════════════════════
; МИКРОБОКС ЛАЙНЕР - Автономный робот следующий по линии
; ═══════════════════════════════════════════════════════════════

[env:liner-debug]
extends = env
build_flags =
    ${env.build_flags}
    -D TARGET_LINER
    -D DEBUG=1
    -D CORE_DEBUG_LEVEL=4

[env:liner-release]
extends = env
build_flags =
    ${env.build_flags}
    -D TARGET_LINER
    -D DEBUG=0
    -O2

; ═══════════════════════════════════════════════════════════════
; МИКРОБОКС БРЕЙН - Модуль управления для других роботов
; ═══════════════════════════════════════════════════════════════

[env:brain-debug]
extends = env
build_flags =
    ${env.build_flags}
    -D TARGET_BRAIN
    -D DEBUG=1
    -D CORE_DEBUG_LEVEL=4

[env:brain-release]
extends = env
build_flags =
    ${env.build_flags}
    -D TARGET_BRAIN
    -D DEBUG=0
    -O2

; ═══════════════════════════════════════════════════════════════
; ОБРАТНАЯ СОВМЕСТИМОСТЬ - старые названия (используют Classic)
; ═══════════════════════════════════════════════════════════════

[env:debug]
extends = env:classic-debug

[env:release]
extends = env:classic-release
